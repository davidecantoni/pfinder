(function(){
'use strict';

app.config(function($mdThemingProvider, $mdIconProvider) {
  var background = $mdThemingProvider.extendPalette('grey', {
    'A100': 'f2f2f2'
  });
  $mdThemingProvider.definePalette('background', background);
  $mdThemingProvider.theme('default');

  $mdThemingProvider.theme('default')
    .primaryPalette('light-blue', {
      'default': '400',
      'hue-1': '100',
      'hue-2': '600',
      'hue-3': 'A100'
    })
    .backgroundPalette('grey')
    .accentPalette('blue-grey', {
      'default': '200' // use shade 200 for default, and keep all other shades the same
    });

  // Since we're using fontawesome instead of material icons
  $mdIconProvider
    .defaultIconSet('/icons/sets/core-icons.svg', 24);
});

app.filter('limitWordsTo', function () {
  return function (value, wordwise, max, tail) {
    if (!value) return '';

    max = parseInt(max, 10);
    if (!max) return value;
    if (value.length <= max) return value;

    value = value.substr(0, max);
    if (wordwise) {
      var lastspace = value.lastIndexOf(' ');
      if (lastspace != -1) {
        //Also remove . and , so its gives a cleaner result.
        if (value.charAt(lastspace-1) == '.' || value.charAt(lastspace-1) == ',') {
          lastspace = lastspace - 1;
        }
        value = value.substr(0, lastspace);
      }
    }

    return value + (tail || ' â€¦');
  };
});

app.controller('MainController', function($scope, $mdSidenav, $mdMedia) {
  $scope.toggleSidebar = function() {
    $mdSidenav('left').toggle();
  };
  // Detecting which media query user is currently on
  $scope.$mdMedia = $mdMedia;
});
})();





(function(){
  'use strict';

  app.controller('PropertiesController', function($scope, $http) {
    $scope.state = 'loading';

    $scope.properties = $http({
      method: 'GET',
      url: 'https://www.propertyfinder.ae/en/find-broker/ajax/search?page=1',
      async: false
    }).success(function(response) {
      $scope.properties = response.data;
      $scope.state = 'loaded';
    });
    
    /**** Carousel logic in pure js ***/
    var slides = document.getElementsByClassName('properties__carousel-item');
    console.log(slides.length)
    var currentSlide = 0;
    setInterval(nextSlide,5000);

    function nextSlide(){
      goToSlide(currentSlide+1);
    }

    function previousSlide(){
      goToSlide(currentSlide-1);
    }

    function goToSlide(n){
      slides[currentSlide].className = 'properties__carousel-item';
      currentSlide = (n+slides.length)%slides.length;
      setTimeout(function(){
        slides[currentSlide].className = 'properties__carousel-item properties__carousel-item--showing';
      }, 800);
    }

    var next = document.getElementById('next');
    var previous = document.getElementById('previous');

    next.onclick = function(){
      nextSlide();
    };
    previous.onclick = function(){
      previousSlide();
    };

  });

})();


(function(){
  'use strict';

  app.controller('HomeController', function() {

  });

})();
